Residents of a besieged Afghan city have been urged to evacuate ahead of an army operation against the Taliban.

General Sami Sadat, who is leading the battle against the Taliban in the southern province of Helmand, called on people to leave its capital Lashkar Gah as soon as possible.

At least 40 civilians have been killed in Lashkar Gah in the past day amid intense fighting, the UN says.

The Taliban are reported to have captured most of the city.

But the fighting is continuing and government forces have vowed not to let it fall into militant hands.

In a message to residents of the city, Gen Sadat said the army would "not leave a single Taliban alive".

"I know it is very difficult for you to leave your houses - it is hard for us too - but if you are displaced for a few days please forgive us," he said.

Gen Sadat earlier told the BBC that while government forces had lost ground, he believed the Taliban would be unable to sustain their assault.

The Taliban assault in Helmand province is part of a major offensive across Afghanistan.

The militants have made rapid advances in recent months as US forces have withdrawn after 20 years of military operations in the country.

Helmand was the centrepiece of the US and British military campaign, and any Taliban gains there would be a blow for the Afghan government.

If Lashkar Gah fell, it would be the first provincial capital won by the Taliban since 2016, when they briefly held the northern city of Kunduz.

'Corpses on the roads'
Residents of Lashkar Gah say they are living in fear as the city faces heavy assault from the militants, who are being targeted with US and Afghan air strikes.

"Neither the Taliban will have mercy on us nor will the government stop the bombing. There are corpses on the roads. We do not know if they are civilians or the Taliban," one resident told the BBC.

Another said: "I do not know where to go, there are clashes in every corner of the city."

Who are the Taliban?
How the Taliban retook half of Afghanistan
I was an Afghan interpreter left homeless in US
The United Nations Assistance Mission in Afghanistan (Unama) says civilians are "bearing the brunt" of the fighting, with the Taliban ground offensive and Afghan air strikes causing the most harm.

It has called on both sides to do more to protect civilians, including an immediate end to fighting in urban areas.

In addition to the fatalities, dozens of people have been injured and thousands displaced, according to Unama.

Doctors in Lashkar Gah say they are overwhelmed and running low on supplies. "There is fighting all around," one told the BBC.

An Afghan interpreter living in the city said his life was under threat from the Taliban because he had worked for the British forces.

"My own house which I left yesterday has been captured by the Taliban and they are living there and they were asking for me," he said.

"We don't know what will happen in the future but they are looking from house to house to find the people who worked for Nato."

Gen Sadat told the BBC the Taliban were being supported by fighters from other Islamist groups and warned that their gains posed a threat beyond Afghanistan.

"This will increase the hope for small extremist groups to mobilise in the cities of Europe and America, and will have a devastating effect on global security," he said.

"This is not a war of Afghanistan, this is a war between liberty and totalitarianism."

What is happening elsewhere?
Lashkar Gah is one of three provincial capitals under attack.

Attempts by the militants to capture Kandahar, Afghanistan's second-largest city, have continued after rocket strikes hit its airport on Sunday.

Seizing control of Kandahar would be a huge victory for the Taliban, giving them a grip on the south of the country.

Unama says five civilians have been killed and 42 wounded over the past three days.

In a third besieged city, Herat, in the west, government commandos are battling the insurgents after days of fierce fighting. Government forces have taken back some areas after a UN compound was attacked on Friday.

Videos shared on social media appeared to show residents on the streets and rooftops of Herat shouting "Allahu akbar" ("God is greatest") in support of the government's gains.

As government forces struggled to contain Taliban advances, President Ashraf Ghani blamed the sudden withdrawal of US troops for the increase in fighting.

"The reason for our current situation is that the decision was taken abruptly," he told parliament on Monday.

Mr Ghani said he had warned Washington that the withdrawal would have "consequences".

Although nearly all its military forces have left, the US has continued its air offensive in support of government troops.

President Biden's administration announced on Monday that because of the increase in violence, it would take in thousands more Afghan refugees who worked with US forces.

The US and UK have accused the Taliban of committing possible war crimes by "massacring civilians" in a town captured near the Pakistan border.

US Secretary of State Antony Blinken said he had seen reports of "deeply disturbing" Taliban atrocities.

Gruesome videos that emerged from Spin Boldak apparently showed revenge killings. The Taliban have rejected the accusations.